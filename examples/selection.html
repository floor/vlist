<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>vlist - Selection Example</title>
  <link rel="stylesheet" href="../dist/vlist.css">
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      background: #f5f5f5;
      padding: 20px;
    }

    h1 {
      margin-bottom: 10px;
      color: #333;
    }

    .description {
      color: #666;
      margin-bottom: 20px;
    }

    .controls {
      display: flex;
      gap: 10px;
      margin-bottom: 15px;
      flex-wrap: wrap;
    }

    button {
      padding: 8px 16px;
      border: none;
      border-radius: 6px;
      background: #667eea;
      color: white;
      font-size: 14px;
      cursor: pointer;
      transition: background 0.2s;
    }

    button:hover {
      background: #5a6fd6;
    }

    button:disabled {
      background: #ccc;
      cursor: not-allowed;
    }

    .mode-toggle {
      display: flex;
      gap: 5px;
      background: #e0e0e0;
      padding: 4px;
      border-radius: 8px;
    }

    .mode-toggle button {
      background: transparent;
      color: #666;
      padding: 6px 12px;
    }

    .mode-toggle button.active {
      background: white;
      color: #333;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }

    .mode-toggle button:hover:not(.active) {
      background: rgba(255,255,255,0.5);
    }

    .selection-info {
      background: #fff;
      padding: 12px 15px;
      border-radius: 8px;
      margin-bottom: 15px;
      font-size: 14px;
      min-height: 44px;
    }

    .selection-count {
      color: #667eea;
      font-weight: 600;
    }

    .selected-names {
      color: #666;
      margin-top: 5px;
      font-size: 13px;
    }

    #list-container {
      height: 450px;
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      overflow: hidden;
    }

    .item-content {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 0 16px;
      height: 100%;
      cursor: pointer;
      transition: background 0.15s;
    }

    .item-checkbox {
      width: 20px;
      height: 20px;
      border: 2px solid #ccc;
      border-radius: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      transition: all 0.15s;
    }

    .item-checkbox.checked {
      background: #667eea;
      border-color: #667eea;
    }

    .item-checkbox.checked::after {
      content: '✓';
      color: white;
      font-size: 12px;
      font-weight: bold;
    }

    .item-avatar {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: 600;
      font-size: 14px;
      flex-shrink: 0;
    }

    .item-details {
      flex: 1;
      min-width: 0;
    }

    .item-name {
      font-weight: 500;
      color: #333;
    }

    .item-role {
      font-size: 12px;
      color: #888;
    }

    .keyboard-hint {
      margin-top: 15px;
      padding: 12px;
      background: #fff;
      border-radius: 8px;
      font-size: 13px;
      color: #666;
    }

    .keyboard-hint strong {
      color: #333;
    }

    kbd {
      background: #eee;
      padding: 2px 6px;
      border-radius: 4px;
      font-family: monospace;
      font-size: 12px;
      border: 1px solid #ddd;
    }
  </style>
</head>
<body>
  <h1>✅ Selection Example</h1>
  <p class="description">Click items to select them. Use keyboard navigation with arrow keys.</p>

  <div class="controls">
    <div class="mode-toggle">
      <button id="mode-single">Single</button>
      <button id="mode-multiple" class="active">Multiple</button>
    </div>
    <button id="select-all">Select All</button>
    <button id="clear-selection">Clear Selection</button>
    <button id="select-first-10">Select First 10</button>
  </div>

  <div class="selection-info" id="selection-info">
    <span class="selection-count">0 items selected</span>
  </div>

  <div id="list-container"></div>

  <div class="keyboard-hint">
    <strong>Keyboard shortcuts:</strong>
    <kbd>↑</kbd> <kbd>↓</kbd> Navigate |
    <kbd>Space</kbd> or <kbd>Enter</kbd> Toggle selection |
    <kbd>Home</kbd> First item |
    <kbd>End</kbd> Last item
  </div>

  <script type="module">
    import { createVList } from '../dist/index.js';

    const roles = ['Developer', 'Designer', 'Manager', 'Analyst', 'Engineer', 'Director', 'Lead', 'Intern'];
    const colors = ['#667eea', '#f093fb', '#4facfe', '#43e97b', '#fa709a', '#fee140', '#30cfd0', '#a8edea'];

    // Generate test items
    const items = Array.from({ length: 1000 }, (_, i) => ({
      id: i + 1,
      name: `Employee ${i + 1}`,
      role: roles[i % roles.length],
      initials: `E${i + 1}`,
      color: colors[i % colors.length],
    }));

    let currentMode = 'multiple';
    let list;

    // Create list function
    const createList = (mode) => {
      // Destroy existing list
      if (list) {
        list.destroy();
      }

      list = createVList({
        container: '#list-container',
        itemHeight: 56,
        items: items,
        selection: {
          mode: mode,
          initial: [],
        },
        template: (item, index, { selected, focused }) => `
          <div class="item-content" style="${focused ? 'background: #f0f4ff;' : ''}">
            <div class="item-checkbox ${selected ? 'checked' : ''}"></div>
            <div class="item-avatar" style="background: ${item.color}">${item.initials.slice(0, 2)}</div>
            <div class="item-details">
              <div class="item-name">${item.name}</div>
              <div class="item-role">${item.role}</div>
            </div>
          </div>
        `,
      });

      // Handle selection changes
      list.on('selection:change', ({ selected, items: selectedItems }) => {
        updateSelectionInfo(selected, selectedItems);
      });

      // Focus the list for keyboard navigation
      list.element.setAttribute('tabindex', '0');
      list.element.focus();
    };

    // Update selection info display
    const updateSelectionInfo = (selected, selectedItems) => {
      const count = selected.length;
      let html = `<span class="selection-count">${count} item${count !== 1 ? 's' : ''} selected</span>`;

      if (count > 0 && count <= 5) {
        const names = selectedItems.map(item => item.name).join(', ');
        html += `<div class="selected-names">${names}</div>`;
      } else if (count > 5) {
        const names = selectedItems.slice(0, 5).map(item => item.name).join(', ');
        html += `<div class="selected-names">${names}, and ${count - 5} more...</div>`;
      }

      document.getElementById('selection-info').innerHTML = html;
    };

    // Mode toggle
    document.getElementById('mode-single').addEventListener('click', () => {
      currentMode = 'single';
      document.getElementById('mode-single').classList.add('active');
      document.getElementById('mode-multiple').classList.remove('active');
      document.getElementById('select-all').disabled = true;
      createList('single');
    });

    document.getElementById('mode-multiple').addEventListener('click', () => {
      currentMode = 'multiple';
      document.getElementById('mode-multiple').classList.add('active');
      document.getElementById('mode-single').classList.remove('active');
      document.getElementById('select-all').disabled = false;
      createList('multiple');
    });

    // Control buttons
    document.getElementById('select-all').addEventListener('click', () => {
      list.selectAll();
    });

    document.getElementById('clear-selection').addEventListener('click', () => {
      list.clearSelection();
    });

    document.getElementById('select-first-10').addEventListener('click', () => {
      list.clearSelection();
      const first10Ids = items.slice(0, 10).map(item => item.id);
      list.select(...first10Ids);
    });

    // Initialize
    createList('multiple');
    updateSelectionInfo([], []);
  </script>
</body>
</html>
